# -*- coding: utf-8 -*-
"""Untitled108.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/12zGnfhOf1uPlPhRlQEyt7AXCmlbOWApO
"""

import pandas as pd
import matplotlib.pyplot as plt

data=pd.read_csv('/content/Real_Estate_Data.csv')

data.head(20)

data.tail(100)

data.info()

data.describe()

data.isna().sum()

data.head(300)

data.drop(columns=["brokered_by","zip_code","prev_sold_date"],inplace=True)

data

data.isna().sum()

data.dropna(inplace=True)

data.head(20)

data.duplicated().sum()

data.drop_duplicates(inplace=True)

data.duplicated().sum()

data.head()

data["status"].value_counts()

data["state"].value_counts().sort_values(ascending=False).head(10).plot(kind="bar")
plt.title("Number of Houses By state")
plt.ylabel("Number of listing")
plt.xlabel("State")
plt.show()

data.groupby("state")["price"].mean().sort_values(ascending=False).astype(int)

data.groupby("city")["price"].mean().sort_values(ascending=False).astype(int)

data.groupby(["state","city"])["price"].mean().reset_index()

data.select_dtypes(include=["number"]).corr()["price"]

X=data[["bed","bath","house_size"]]

X.head()

y=data["price"]

y.head()

from sklearn.model_selection import train_test_split

X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2)

from sklearn.preprocessing import StandardScaler

scaler=StandardScaler()

X_train=scaler.fit_transform(X_train)

X_train

import joblib
joblib.dump(scaler,"scaler.pkl")

X_test=scaler.fit_transform(X_test)

from sklearn.linear_model import LinearRegression

lr=LinearRegression()

lr.fit(X_train,y_train)

y_pred=lr.predict(X_test)

from sklearn.metrics import mean_absolute_error

mean_absolute_error(y_test,y_pred)

joblib.dump(lr,"model.pkl")

print(pd.__version__)

import numpy as np

print(np.__version__)





